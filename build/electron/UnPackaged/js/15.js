(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[15],{"4e99":function(t,e,a){"use strict";a.r(e);var o=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{ref:"scrollEl",staticClass:"local-favorite",class:{web:!t.isElectron}},[a("input",{ref:"fileSelector",staticStyle:{display:"none"},attrs:{type:"file",name:"input-file",accept:".json"},on:{change:t.onFileChange}}),a("div",{staticClass:"library-inner-container"},[a("q-table",{staticClass:"library-table full-width full-height",attrs:{grid:"","no-data-label":t.$t("credit_no_data"),"loading-label":t.$t("loading"),pagination:t.pagination,data:t.tableData},on:{"update:pagination":function(e){t.pagination=e}},scopedSlots:t._u([{key:"loading",fn:function(){return[a("div",{staticClass:"column items-center no-pointer-events library-table__loading"},[t.filteredFavorites.length?a("q-linear-progress",{staticClass:"absolute-top",attrs:{indeterminate:"",size:"xs",color:"general","track-color":"transparent"}}):a("div",{staticClass:"q-pa-md rounded-borders bg-page"},[a("div",{staticClass:"flex"},[a("q-spinner-ios",{attrs:{size:"1.2rem",color:"general"}}),a("div",{staticClass:"q-ml-sm"},[t._v(t._s(t.$t("loading"))+"...")])],1),a("div",{staticClass:"q-mt-sm"},[t._v(t._s(t.$t("lib_from_network")))])])],1)]},proxy:!0},{key:"no-data",fn:function(){return[a("q-icon",{attrs:{name:"error_outline",size:"1.2rem"}}),a("div",{staticClass:"q-ml-sm"},[t._v(t._s(t.$t("credit_no_data")))])]},proxy:!0},{key:"item",fn:function(e){return[a("PostCard",{key:e.row.id,staticStyle:{margin:"4px !important"},attrs:{post:e.row,followable:!t.lib.followingChannels.some((function(t){return t.id===e.row.channel.id}))},on:{follow:t.onFollow,preview:t.preview,"to-channel":t.toChannelPage}})]}},{key:"bottom",fn:function(){return[a("q-separator",{staticClass:"full-width bg-general"}),a("div",{staticClass:"row justify-center items-center full-width",staticStyle:{height:"50px"}},[a("q-pagination",{attrs:{unelevated:"",color:"general","text-color":"general",max:t.pagesNumber,"max-pages":5,ellipses:!1,"boundary-numbers":!1,"direction-links":"","boundary-links":"",size:"md"},model:{value:t.pagination.page,callback:function(e){t.$set(t.pagination,"page",e)},expression:"pagination.page"}})],1)]},proxy:!0}])})],1),t._e(),a("BackToTop",{attrs:{show:t.scrollIndex>0||t.showBackToTop},on:{click:t.handleBackToTop}}),a("div",{staticClass:"fixed-bottom-right save-or-load",class:{higher:t.scrollIndex>0||t.showBackToTop}},[a("q-btn",{staticClass:"backup-btn q-ma-xs",class:{hide:t.hideBtn},attrs:{fab:"","no-wrap":"",size:"18px",color:"primary",icon:"source"},on:{click:t.saveOrLoad}},[a("div",{staticClass:"fab-inner-text"},[t._v(t._s(t.$t("backup")))])])],1),a("q-dialog",{model:{value:t.showPreview,callback:function(e){t.showPreview=e},expression:"showPreview"}},[a("q-card",{staticClass:"image-preview-card"},[a("q-card-section",{staticClass:"q-pa-none"},[a("img",{staticClass:"preview-image",attrs:{src:t.previewImage}})]),a("q-card-actions",{staticClass:"q-pa-none",staticStyle:{position:"absolute",bottom:"0",right:"0"},attrs:{align:"right"}},[a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",padding:"none",size:"20px",icon:"close",color:"grey"}})],1)],1)],1),a("q-dialog",{model:{value:t.showDialog,callback:function(e){t.showDialog=e},expression:"showDialog"}},[a("q-card",[a("q-card-section",{staticClass:"row"},[a("div",{staticClass:"text-h6 col-12"},[t._v(t._s(t.$t("import_or_export_favorites")))]),a("div",{staticClass:"col-12"},[t._v("\n          Total: "+t._s(t.favorites.length)+"\n        ")]),a("div",{staticClass:"btns col-12 text-right q-mt-md"},[a("q-btn",{attrs:{color:"primary",flat:"",icon:"save",label:t.$t("export_local_favorites")},on:{click:t.exportData}}),a("q-btn",{staticClass:"q-ml-md",attrs:{color:"primary",flat:"",icon:"add",label:t.$t("import_favorites_file")},on:{click:t.importData}})],1)])],1)],1)],1)},i=[],s=(a("e01a"),a("e9c4"),a("71ac")),n=a("2de9"),l=a("0ebe"),r=a("4aad"),c=a("bae3"),d=a("ed08"),p=a("e64e"),h=a("decc"),v=a("3013"),f={name:"LibraryFavorite",components:{PostCard:n["a"],BackToTop:l["a"]},mixins:[p["a"],Object(h["a"])("favorite"),v["a"]],data(){return{isElectron:Object(d["isElectron"])(),hideBtn:!1,favorites:s["a"].list(),scrollIndex:0,showPreview:!1,previewImage:"",showDialog:!1,lib:r["a"]}},computed:{filteredFavorites(){const t=this.searchText.toLowerCase(),e=r["a"].search.option.value,a=t=>{var a;switch(e){case"channel":return null===(a=t.channel)||void 0===a?void 0:a.title;case"postID":return t.id;case"postDesc":return t.description;default:return t.title}},o=e=>{var o;return null===(o=a(e))||void 0===o?void 0:o.toLowerCase().includes(t)};return this.favorites.filter(o)}},methods:{onScroll(t){this.scrollIndex=t.index},preview(t){this.previewImage=t,this.showPreview=!0},remove(t){return s["a"].remove(t)},saveOrLoad(){this.showDialog=!0},exportData(){Object(c["g"])(JSON.stringify({favorites:this.favorites}),"favorites.json"),this.showDialog=!1},importData(){console.log(this.$refs.fileSelector),this.$refs.fileSelector.value="",this.$refs.fileSelector.click()},onFileChange(t){var e,a;null!==t&&void 0!==t&&null!==(e=t.target)&&void 0!==e&&null!==(a=e.files)&&void 0!==a&&a[0]&&Object(c["f"])(t.target.files[0]).then((t=>{if(!t)return this.$q.notify("Cannot read data from this file");const e=JSON.parse(t);if(!e.favorites||!Array.isArray(e.favorites))return this.$q.notify(this.$t("not_a_favorite_file"));s["a"].set(e.favorites),this.showDialog=!1}))},onFollow(t){if(r["a"].followingChannels.some((e=>e.id===t||e.soul===t)))return console.log("unfollow"),r["a"].unfollowChannel(t).then(console.log);console.log("follow"),r["a"].followChannel(t).then(console.log)},toChannelPage(t){console.log("to",t);const e=["id","title"].map((e=>{const a=t[e];return encodeURIComponent(e)+"="+encodeURIComponent(a)})).join("&"),a=`/library/channel?${e}`;this.$root.$emit("navigate-to",a),this.$router.push(a)},setSearch(){this.lib.setSearchOption([{label:this.$t("post_title"),value:"postTitle"},{label:this.$t("description"),value:"postDesc"},{label:this.$t("channel_title"),value:"channel"}])}},activated(){this.setSearch(),this.$root.$emit("navigate-to"),this.$root.$emit("navigate-to","/library/favorite"),this.hideBtn=!0,setTimeout((()=>{this.hideBtn=!1}),300)},deactivated(){this.hideBtn=!0}},u=f,g=(a("b34a"),a("2877")),m=a("eaac"),b=a("6b1d"),w=a("d9b2"),C=a("0016"),_=a("eb85"),x=a("3b16"),y=a("a12b"),q=a("9c40"),$=a("24e8"),k=a("f09f"),S=a("a370"),D=a("4b7e"),T=a("7f67"),I=a("eebe"),P=a.n(I),Q=Object(g["a"])(u,o,i,!1,null,"728e3322",null);e["default"]=Q.exports;P()(Q,"components",{QTable:m["a"],QLinearProgress:b["a"],QSpinnerIos:w["a"],QIcon:C["a"],QSeparator:_["a"],QPagination:x["a"],QVirtualScroll:y["a"],QBtn:q["a"],QDialog:$["a"],QCard:k["a"],QCardSection:S["a"],QCardActions:D["a"]}),P()(Q,"directives",{ClosePopup:T["a"]})},"66a9":function(t,e,a){},b34a:function(t,e,a){"use strict";a("66a9")}}]);